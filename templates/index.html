<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyyperwan</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        // Function to toggle alias editing form visibility
        function toggleAliasForm(interfaceName) {
            const form = document.getElementById('alias-form-' + interfaceName);
            const displayElem = document.getElementById('alias-display-' + interfaceName);
            
            if (form.style.display === 'none' || form.style.display === '') {
                form.style.display = 'block';
                displayElem.style.display = 'none';
            } else {
                form.style.display = 'none';
                displayElem.style.display = 'block';
            }
        }
    </script>
</head>
<body>
    <h1>HyyperWan</h1>
    
    <!-- Flash messages section -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <table>
        <thead>
            <tr>
                <th>Interface</th>
                <th>IP Address</th>
                <th>Latency</th>
                <th>Loss</th>
                <th>Jitter</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for interface in interfaces %}
            <tr>
                <td>
                    <!-- Interface name with alias display and edit functionality -->
                    <div id="alias-display-{{ interface.name }}" class="interface-name-display">
                        <strong>{{ interface.name }}</strong>
                        {% if interface.alias %}
                            <br>
                            <span class="interface-alias">({{ interface.alias }})</span>
                        {% endif %}
                        <button type="button" class="alias-edit-button" 
                                onclick="toggleAliasForm('{{ interface.name }}')">
                            {% if interface.alias %}Edit{% else %}Add{% endif %} Alias
                        </button>
                    </div>
                    
                    <!-- Hidden form for editing alias -->
                    <div id="alias-form-{{ interface.name }}" class="alias-edit-form" style="display: none;">
                        <form action="{{ url_for('update_interface_alias') }}" method="post">
                            <input type="hidden" name="interface" value="{{ interface.name }}">
                            <input type="text" name="alias" value="{{ interface.alias }}" 
                                   placeholder="Enter interface alias">
                            <button type="submit">Save</button>
                            <button type="button" onclick="toggleAliasForm('{{ interface.name }}')">Cancel</button>
                        </form>
                    </div>
                </td>
                <td>{{ interface.ip }}</td>
                <td>{{ interface.latency }}</td>
                <td>{{ interface.loss }}</td>
                <td>{{ interface.jitter }}</td>
                <td>
                    <form id="apply_interface" action="{{ url_for('apply_interface') }}" method="post">
                        <input type="hidden" name="interface" value="{{ interface.name }}">
                        <input type="text" name="latency" placeholder="Latency (e.g., 100ms)">
                        <input type="text" name="loss" placeholder="Loss (e.g., 1%)">
                        <input type="text" name="jitter" placeholder="Jitter (e.g., 10ms)">
                        <button type="submit">Apply</button>
                    </form>
                    <form action="{{ url_for('remove_interface') }}" method="post">
                        <input type="hidden" name="interface" value="{{ interface.name }}">
                        <button type="submit">Remove</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Reset All button -->
    <div class="reset-all-container">
        <form action="{{ url_for('reset_all_interfaces') }}" method="post">
            <button type="submit" class="reset-all-button">Reset All Interfaces</button>
        </form>
    </div>
</body>
</html>